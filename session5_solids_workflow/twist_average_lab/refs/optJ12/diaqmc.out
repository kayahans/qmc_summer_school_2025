  Input file(s): diaqmc.in.xml 
================================================================
                        QMCPACK 4.1.9

          (c) Copyright 2003-2025 QMCPACK developers

                         Please cite:
      J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
           https://doi.org/10.1088/1361-648X/aab9c3
                             and
       P. Kent et al. J. Chem. Phys. 152 174105 (2020)
              https://doi.org/10.1063/5.0004860

  Git branch: develop
  Last git commit: 76b83bc7dfda9855aede70878988c10c5f0c5fe6
  Last git commit date: Wed Jul 9 11:33:49 2025 -0700
  Last git commit subject: Merge pull request #5569 from prckent/unreleased_log
================================================================
  Global options 

  Total number of MPI ranks = 1
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 1
  MPI ranks per node        = 1
  OMP 1st level threads     = 4
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  CPU only build
  Complex build. QMC_COMPLEX=ON
  Timer build option is enabled. Current timer level is coarse

=================================================
--- Memory usage report : when QMCPACK starts ---
=================================================
Available memory on node 0, free + buffers :   29794 MiB
Memory footprint by rank 0 on node 0       :      28 MiB
=================================================

  Input XML = diaqmc.in.xml

  Project = diaqmc
  date    = 2025-07-14 11:32:43 MDT
  host    = s1002448

  hamiltonian has MPC. Will read density if it is found.


 Random Number
 -------------
  Offset for the random number seeds based on time: 827

  Range of prime numbers to use as seeds over processors and threads = 6361-6389


 Lattice
 -------
  Simulation cell radius   = 3.373161 bohr
  Wigner-Seitz cell radius = 3.373161 bohr

  Overwriting global supercell 
  Long-range breakup parameters:
    rc*kc = 15.000000; rc = 3.373161; kc = 4.446867; tol = 0.000300
  Long-range breakup parameters:
    rc*kc = 15.000000; rc = 3.373161; kc = 4.446867; tol = 0.000300
  KContainer initialised with cutoff 4.446867
   # of K-shell  = 21
   # of K points = 460

  Lattice (bohr):      6.7463223000                 0                 0
                                  0      6.7463223000                 0
                                  0                 0      6.7463223000

  Boundary Conditions:  p  p  p 

  Volume (bohr^3) = 307.0444532224

  Reciprocal vectors without 2*pi.
    g_1 =       0.1482289098                 0                 0
    g_2 =                  0      0.1482289098                 0
    g_3 =                  0                 0      0.1482289098

  Metric tensor in real-space.
    h_1 = 45.5128645755 0.0000000000 0.0000000000 
    h_2 = 0.0000000000 45.5128645755 0.0000000000 
    h_3 = 0.0000000000 0.0000000000 45.5128645755 

  Metric tensor in g-space.
    h_1 = 0.8674122794 0.0000000000 0.0000000000 
    h_2 = 0.0000000000 0.8674122794 0.0000000000 
    h_3 = 0.0000000000 0.0000000000 0.8674122794 

 Particle Set
 ------------
  Name: e   Offload : no

  All the species have the same mass 1.0000000000

  Creating Structure Factor for periodic systems 4.4468672954
  Particle set size: 32   Groups : 2


 Particle Set
 ------------
  Name: ion0   Offload : no

  All the species have the same mass 21894.7135905729

  Creating Structure Factor for periodic systems 4.4468672954
  Particle set size: 8   Groups : 1


 Many-body wavefunction
 -------------------
  Name: psi0   Tasking: no


   Single particle orbitals (SPO) collection
   -----------------------------------------
    Name: bspline   Type input: bspline

  Created SPOSet builder named 'bspline' of type bspline

     Single particle orbitals (SPO)
     ------------------------------
      Name: spo_ud   Type: spline   Builder class name: EinsplineSetBuilder

  TileMatrix = 
 [  1 -1  1
    1  1 -1
   -1  1  1 ]
  Reading 16 orbitals from HDF5 file.
  HDF5 orbital file version 2.1.0
  Reading orbital file in ESHDF format.
  ESHDF orbital file version 2.1.0
  Lattice = 
    [  3.373161  3.373161 -0.000000
       0.000000  3.373161  3.373161
       3.373161  0.000000  3.373161 ]
  SuperLattice = 
    [  6.746322  0.000000  0.000000
       0.000000  6.746322  0.000000
       0.000000  0.000000  6.746322 ]

bands=8, elecs=32, spins=1, twists=4
Atom type(0) = 6
Atom type(1) = 6
  Read 115633 density G-vectors.
  EinsplineSetBuilder found density in the HDF5 file.
  Read 0 VHXC G-vectors.
TIMER  EinsplineSetBuilder::ReadOrbitalInfo 0.0067922150
TIMER  EinsplineSetBuilder::BroadcastOrbitalInfo 0.0000003540
Found 1 distinct supercell twist based on 4 primitive cell k-points
Super twist #0:  [   0.00000   0.00000   0.00000 ]
QMCPACK WARNING twist attribute does't exist but twistnum attribute was found. This is potentially ambiguous. Specifying twist attribute is preferred.
  Using supercell twist 0:  [   0.00000   0.00000   0.00000]
32 complex-valued orbitals supplied by h5 can be expanded up to 32 SPOs.
Sorting the bands now:
We will read 16 distinct complex-valued orbitals from h5.
B-spline mesh factor is 1.0000000000
B-spline mesh size is (44, 44, 44)
Maxmimum number of Gvecs 4122
    Using complex valued spline SPOs with complex single precision storage (C2C).
    Running on CPU.
    Running on CPU.
BandInfoGroup::selectBands bigspace has 32 distinct orbitals 
BandInfoGroup::selectBands using distinct orbitals [0,16)
  Number of distinct bands 16
  First Band index 0
  First SPO index 0
  Size of SPOs 16
  ClassName = SplineC2C
  Using complex einspline table
NumDistinctOrbitals 16 numOrbs = 16
MEMORY 12 MB allocated for the coefficients in 3D spline orbital representation
Start transforming plane waves to 3D B-Splines.
  Time to gather the table = 0.0000028150
  SplineSetReader initialize_spline_pio 0.2439507660 sec
  Time to bcast the table = 0.0000004350
Time spent in creating B-spline SPOs 0.2490045540 sec

   Single Slater determinant
   -------------------------

     Determinant
     -----------
      Name: updet   Spin group: 0   SPO name: spo_ud

      Setting delay_rank to default value 1
      Using rank-1 Sherman-Morrison Fahy update (SM1)
      Running on CPU.


     Determinant
     -----------
      Name: downdet   Spin group: 1   SPO name: spo_ud

      Setting delay_rank to default value 1
      Using rank-1 Sherman-Morrison Fahy update (SM1)
      Running on CPU.

  Added a fermionic WaveFunctionComponent SlaterDet

   Jastrow
   -------
    Name: J1   Type: One-Body   Function: bspline

    Radial function for element: C - e
     Number of parameters: 7
     Cusp: 0.0000000000
     Cutoff radius: 3.3700000000

     Name                        Value Type Use Index
     ---- ---------------------------- ---- --- -----
     eC_0                 0.000000e+00    1  ON     0
     eC_1                 0.000000e+00    1  ON     1
     eC_2                 0.000000e+00    1  ON     2
     eC_3                 0.000000e+00    1  ON     3
     eC_4                 0.000000e+00    1  ON     4
     eC_5                 0.000000e+00    1  ON     5
     eC_6                 0.000000e+00    1  ON     6


   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: bspline

    Radial function for species: u - u
     Number of parameters: 7
     Cusp: -0.25
     Cutoff radius: 3.37

     Name                        Value Type Use Index
     ---- ---------------------------- ---- --- -----
     uu_0                 0.000000e+00    1  ON     0
     uu_1                 0.000000e+00    1  ON     1
     uu_2                 0.000000e+00    1  ON     2
     uu_3                 0.000000e+00    1  ON     3
     uu_4                 0.000000e+00    1  ON     4
     uu_5                 0.000000e+00    1  ON     5
     uu_6                 0.000000e+00    1  ON     6

    Radial function for species: u - d
     Number of parameters: 7
     Cusp: -0.5
     Cutoff radius: 3.37

     Name                        Value Type Use Index
     ---- ---------------------------- ---- --- -----
     ud_0                 0.000000e+00    1  ON     0
     ud_1                 0.000000e+00    1  ON     1
     ud_2                 0.000000e+00    1  ON     2
     ud_3                 0.000000e+00    1  ON     3
     ud_4                 0.000000e+00    1  ON     4
     ud_5                 0.000000e+00    1  ON     5
     ud_6                 0.000000e+00    1  ON     6

  Wave function psi0 parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                 0.000000e+00    1  ON     0
    eC_1                 0.000000e+00    1  ON     1
    eC_2                 0.000000e+00    1  ON     2
    eC_3                 0.000000e+00    1  ON     3
    eC_4                 0.000000e+00    1  ON     4
    eC_5                 0.000000e+00    1  ON     5
    eC_6                 0.000000e+00    1  ON     6
    uu_0                 0.000000e+00    1  ON     7
    uu_1                 0.000000e+00    1  ON     8
    uu_2                 0.000000e+00    1  ON     9
    uu_3                 0.000000e+00    1  ON    10
    uu_4                 0.000000e+00    1  ON    11
    uu_5                 0.000000e+00    1  ON    12
    uu_6                 0.000000e+00    1  ON    13
    ud_0                 0.000000e+00    1  ON    14
    ud_1                 0.000000e+00    1  ON    15
    ud_2                 0.000000e+00    1  ON    16
    ud_3                 0.000000e+00    1  ON    17
    ud_4                 0.000000e+00    1  ON    18
    ud_5                 0.000000e+00    1  ON    19
    ud_6                 0.000000e+00    1  ON    20

  Adding psi0 TrialWaveFunction to the pool

 Hamiltonian and observables
 ---------------------------
  Name: h0

  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 

   Pseudo Potential
   ----------------
    Name: PseudoPot   Wavefunction : psi0


  Adding pseudopotential for C
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
QMCPACK WARNING Nrule was not determined from qmcpack input or pseudopotential file. Setting sensible default.
    Assuming Hartree unit
 l-local setting found in pseudopotential file and used.
   Number of angular momentum channels 2
   Maximum angular momentum channel (Lmax) 1
   Creating a Linear Grid Rmax=1.405
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
  Quadrature Nrule: 4
    Non-local pseudopotential parameters
    Maximum angular momentum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405
    Number of spherical integration grid points = 12
    Spherical grid and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.405

  Creating CoulombHandler with the Esler Optimized Breakup. 
  KContainer initialised with cutoff 27.94049125
   # of K-shell  = 752
   # of K points = 112930

  NUMBER OF OPT_BREAK KVECS = 29180498243
 finding kc:  4.446867295 , 4.446867295
  LRBreakp parameter Kc =4.446867295
    Continuum approximation in k = [27.94049125,1778.746918)

   LR Breakup chi^2 = 4.65689e-16
   Constant of PBCAB 15.368
    CoulombPBCAB::initBreakup
  Setting a linear grid=[0,3.3732) number of grid points =1001
  Rcut                3.3732
  Maximum K shell     20
  Number of k vectors 460
    CoulombPBCAB::add 
 Setting a linear grid=[0,3.3732) number of grid =3374
    Creating the short-range pseudopotential for species 0
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
    Using batched ratio computing in NonLocalECP
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 

   Coulomb Potential
   -----------------
    Name: ElecElec   Type: AA   PBC: yes

  Clone CoulombHandler. 
   PBCAA self-interaction term -14.536
   PBCAA total constant -22.22
    CoulombPBCAA::initBreakup
  Setting a linear grid=[0,3.3732) number of grid points =1001
  Maximum K shell 20
  Number of k vectors 460
  Fixed Coulomb potential for e
    e-e Madelung Const. =-0.21028475
    Vtot     =0
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

   Coulomb Potential
   -----------------
    Name: IonIon   Type: AA   PBC: yes

  Clone CoulombHandler. 
   PBCAA self-interaction term -58.143445
   PBCAA total constant -65.827519
    CoulombPBCAA::initBreakup
  Setting a linear grid=[0,3.3731612) number of grid points =1001
Checking ion-ion Ewald energy against reference...
  Check passed.
  Maximum K shell 20
  Number of k vectors 460
  Fixed Coulomb potential for ion0
    e-e Madelung Const. =-0.21028475
    Vtot     =-51.102678
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

   MPC Potential
   -------------
    Name: MPC   Physical : no


  === Initializing MPC interaction === 
  Using 609 G-vectors for MPC interaction.
   Using real-space box of size [32,32,32] for MPC spline.
    Linear extrap    = 3.062287875839e-01
    Quadratic extrap = 3.062287875689e-01
    Worst MPC discrepancy:
      Linear Extrap   : -2.48667121981254e-04
      Quadratic Extrap: -2.48673391454602e-04
  Constant potential = 1.808191491549e+02
  === MPC interaction initialized === 

  QMCHamiltonian::addOperator MPC to auxH 
QMCHamiltonian::addOperatorType added type MPC named MPC

  QMCHamiltonian::add2WalkerProperty added
    6 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 9
ParticleSetPool::randomize 1 ParticleSet.
<init source="ion0" target="e">
</init>
  Initialization Execution time = 2.2404e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 32 particles :  u(16) d(16)

    u  7.7474157098e-01  2.0427719221e-01  5.8957740845e+00
    u  6.6757026892e+00  5.9357204337e-01  1.0040274099e+00
    u  8.4599828416e-01  9.9935563661e-01  1.2546902980e+00
    u  9.4770666285e-01  1.4615149247e+00  8.0977004179e-01
    u  4.0796321157e+00  4.0834385138e+00  6.0149046181e-01
    u  3.6294281855e+00  2.8738461780e+00  5.7214331841e+00
    u  6.0539292260e+00  5.6729307467e+00  1.7178272590e+00
    u  5.5139748049e+00  5.7550757260e+00  2.5085105400e+00
    u  1.0700637637e+00  3.8148138195e+00  3.2141253185e+00
    u  5.8207754809e+00  2.7863183507e+00  2.9677421702e+00
    (... and 22 more particle positions ...)

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use orthorhombic periodic cell in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use orthorhombic periodic cell in 3D.


  ParticleSet 'ion0' contains 8 particles :  C(8)

    C                 0                 0                 0
    C  1.6865805800e+00  1.6865805800e+00  1.6865805800e+00
    C  3.3731611500e+00  3.3731611500e+00                 0
    C  5.0597417200e+00  5.0597417200e+00  1.6865805800e+00
    C                 0  3.3731611500e+00  3.3731611500e+00
    C  1.6865805800e+00  5.0597417200e+00  5.0597417200e+00
    C  3.3731611500e+00                 0  3.3731611500e+00
    C  5.0597417200e+00  1.6865805700e+00  5.0597417200e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use orthorhombic periodic cell in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  LocalECP        CoulombPBCAB potential source: ion0
  NonLocalECP     NonLocalECPotential: ion0
  ElecElec        CoulombPBCAA potential: e_e
  IonIon          CoulombPBCAA potential: ion0_ion0

Loop execution max-interations = 3

========================================
  Reading WFOpt driver XML input section
========================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s000
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s000
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29840 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29839 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29839 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.7618e-02 secs
Completed block    1 of 100 average 0.5489 secs/block after 3.242 secs
Completed block   25 of 100 average 0.5497 secs/block after 16.44 secs
Completed block   50 of 100 average 0.5497 secs/block after 30.18 secs
Completed block   75 of 100 average 0.5502 secs/block after 43.96 secs
Completed block  100 of 100 average 0.5505 secs/block after 57.75 secs
====================================================
  End of a VMC section
    QMC counter        = 0
    time step          = 0.1
    reference energy   = -43.9169
    reference variance = 7.36126
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29820 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.5151e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.3917e+01
  VMC Evar = 7.3613e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0693e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.4206e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
  Execution time (eigenvalue) = 4.1349e-04

Among totally 21 optimized parameters, largest LM parameter change : 3.9360e-01 at parameter 14
Effective weight of all the samples measured by correlated sampling is 6.9326e-01

******************************************************************************
Init Cost =  -3.8789e+01    New Cost =  -4.0275e+01  Delta Cost =  -1.4859e+00
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   2.5000e-01
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -2.244090e-01    1  ON     0
    eC_1                -1.739469e-01    1  ON     1
    eC_2                -1.386018e-01    1  ON     2
    eC_3                -9.601181e-02    1  ON     3
    eC_4                -5.781169e-02    1  ON     4
    eC_5                -2.671969e-02    1  ON     5
    eC_6                -7.286888e-03    1  ON     6
    uu_0                 2.318499e-01    1  ON     7
    uu_1                 1.754345e-01    1  ON     8
    uu_2                 1.170331e-01    1  ON     9
    uu_3                 7.524413e-02    1  ON    10
    uu_4                 4.532466e-02    1  ON    11
    uu_5                 2.355451e-02    1  ON    12
    uu_6                 1.173061e-02    1  ON    13
    ud_0                 3.936007e-01    1  ON    14
    ud_1                 2.551936e-01    1  ON    15
    ud_2                 1.564765e-01    1  ON    16
    ud_3                 9.106644e-02    1  ON    17
    ud_4                 4.989603e-02    1  ON    18
    ud_5                 2.500734e-02    1  ON    19
    ud_6                 1.162153e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s000.vp.h5
  Updated wavefunction xml file diaqmc.s000.opt.xml
  QMCLinearOptimizeBatched Execution time = 86.72 secs

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s001
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s001
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29778 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29783 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29783 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.9290e-02 secs
Completed block    1 of 100 average 0.5668 secs/block after 90 secs
Completed block   25 of 100 average 0.5576 secs/block after 103.4 secs
Completed block   50 of 100 average 0.5556 secs/block after 117.2 secs
Completed block   75 of 100 average 0.5554 secs/block after 131.1 secs
Completed block  100 of 100 average 0.5549 secs/block after 144.9 secs
====================================================
  End of a VMC section
    QMC counter        = 1
    time step          = 0.1
    reference energy   = -44.9214
    reference variance = 1.44109
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29840 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.5593e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.4921e+01
  VMC Evar = 1.4410e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0759e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.3524e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
  Execution time (eigenvalue) = 2.8169e-04

Among totally 21 optimized parameters, largest LM parameter change : 1.4995e-01 at parameter 14
Effective weight of all the samples measured by correlated sampling is 9.1818e-01

******************************************************************************
Init Cost =  -4.0285e+01    New Cost =  -4.0394e+01  Delta Cost =  -1.0886e-01
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   6.2500e-02
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.142738e-01    1  ON     0
    eC_1                -2.532824e-01    1  ON     1
    eC_2                -2.027047e-01    1  ON     2
    eC_3                -1.406622e-01    1  ON     3
    eC_4                -8.296112e-02    1  ON     4
    eC_5                -3.695102e-02    1  ON     5
    eC_6                -9.182866e-03    1  ON     6
    uu_0                 3.317583e-01    1  ON     7
    uu_1                 2.541391e-01    1  ON     8
    uu_2                 1.792878e-01    1  ON     9
    uu_3                 1.180938e-01    1  ON    10
    uu_4                 7.246748e-02    1  ON    11
    uu_5                 3.819036e-02    1  ON    12
    uu_6                 1.780751e-02    1  ON    13
    ud_0                 5.435547e-01    1  ON    14
    ud_1                 3.691858e-01    1  ON    15
    ud_2                 2.416554e-01    1  ON    16
    ud_3                 1.488435e-01    1  ON    17
    ud_4                 8.577984e-02    1  ON    18
    ud_5                 4.315272e-02    1  ON    19
    ud_6                 1.905533e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s001.vp.h5
  Updated wavefunction xml file diaqmc.s001.opt.xml
  QMCLinearOptimizeBatched Execution time = 87.13 secs

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s002
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s002
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29833 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29833 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29833 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.8284e-02 secs
Completed block    1 of 100 average 0.5456 secs/block after 177.1 secs
Completed block   25 of 100 average 0.5396 secs/block after 190 secs
Completed block   50 of 100 average 0.5402 secs/block after 203.6 secs
Completed block   75 of 100 average 0.5407 secs/block after 217.1 secs
Completed block  100 of 100 average 0.5405 secs/block after 230.6 secs
====================================================
  End of a VMC section
    QMC counter        = 2
    time step          = 0.1
    reference energy   = -45.0088
    reference variance = 1.5256
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29832 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.4144e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.5009e+01
  VMC Evar = 1.5259e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0485e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.3969e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
  Execution time (eigenvalue) = 2.8019e-04

Among totally 21 optimized parameters, largest LM parameter change : 2.6844e-02 at parameter 7
Effective weight of all the samples measured by correlated sampling is 9.9837e-01

******************************************************************************
Init Cost =  -4.0355e+01    New Cost =  -4.0351e+01  Delta Cost =   4.2281e-03
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   1.5625e-02
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.251498e-01    1  ON     0
    eC_1                -2.687738e-01    1  ON     1
    eC_2                -2.172243e-01    1  ON     2
    eC_3                -1.505568e-01    1  ON     3
    eC_4                -8.778134e-02    1  ON     4
    eC_5                -3.757415e-02    1  ON     5
    eC_6                -1.015978e-02    1  ON     6
    uu_0                 3.586028e-01    1  ON     7
    uu_1                 2.626871e-01    1  ON     8
    uu_2                 1.840495e-01    1  ON     9
    uu_3                 1.211844e-01    1  ON    10
    uu_4                 7.408594e-02    1  ON    11
    uu_5                 3.816208e-02    1  ON    12
    uu_6                 1.750958e-02    1  ON    13
    ud_0                 5.629002e-01    1  ON    14
    ud_1                 3.837781e-01    1  ON    15
    ud_2                 2.530915e-01    1  ON    16
    ud_3                 1.575559e-01    1  ON    17
    ud_4                 9.145432e-02    1  ON    18
    ud_5                 4.581656e-02    1  ON    19
    ud_6                 2.051265e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s002.vp.h5
  Updated wavefunction xml file diaqmc.s002.opt.xml
  QMCLinearOptimizeBatched Execution time = 85.29 secs
Loop execution max-interations = 4

========================================
  Reading WFOpt driver XML input section
========================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s003
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s003
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29778 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29778 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29777 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 9.0487e-02 secs
Completed block    1 of 100 average 0.5748 secs/block after 262.4 secs
Completed block   25 of 100 average 0.5699 secs/block after 276.1 secs
Completed block   50 of 100 average 0.5702 secs/block after 290.3 secs
Completed block   75 of 100 average 0.5705 secs/block after 304.6 secs
Completed block  100 of 100 average 0.5708 secs/block after 318.9 secs
====================================================
  End of a VMC section
    QMC counter        = 3
    time step          = 0.1
    reference energy   = -45.0317
    reference variance = 1.41512
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29829 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.7179e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.5032e+01
  VMC Evar = 1.4151e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0540e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.3828e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
  Execution time (eigenvalue) = 2.7914e-04

Among totally 21 optimized parameters, largest LM parameter change : 1.0605e-02 at parameter 0
Effective weight of all the samples measured by correlated sampling is 9.9987e-01

******************************************************************************
Init Cost =  -4.0387e+01    New Cost =  -4.0388e+01  Delta Cost =  -1.4394e-03
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   2.5000e-01
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.357547e-01    1  ON     0
    eC_1                -2.714608e-01    1  ON     1
    eC_2                -2.172441e-01    1  ON     2
    eC_3                -1.507986e-01    1  ON     3
    eC_4                -8.952912e-02    1  ON     4
    eC_5                -4.055288e-02    1  ON     5
    eC_6                -1.126595e-02    1  ON     6
    uu_0                 3.537817e-01    1  ON     7
    uu_1                 2.629311e-01    1  ON     8
    uu_2                 1.850428e-01    1  ON     9
    uu_3                 1.215445e-01    1  ON    10
    uu_4                 7.379293e-02    1  ON    11
    uu_5                 3.830661e-02    1  ON    12
    uu_6                 1.747768e-02    1  ON    13
    ud_0                 5.603933e-01    1  ON    14
    ud_1                 3.823917e-01    1  ON    15
    ud_2                 2.513543e-01    1  ON    16
    ud_3                 1.559578e-01    1  ON    17
    ud_4                 9.023216e-02    1  ON    18
    ud_5                 4.488942e-02    1  ON    19
    ud_6                 2.002832e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s003.vp.h5
  Updated wavefunction xml file diaqmc.s003.opt.xml
  QMCLinearOptimizeBatched Execution time = 88.44 secs

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s004
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s004
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29754 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29754 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29752 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.7870e-02 secs
Completed block    1 of 100 average 0.5487 secs/block after 350.8 secs
Completed block   25 of 100 average 0.5441 secs/block after 363.9 secs
Completed block   50 of 100 average 0.5458 secs/block after 377.6 secs
Completed block   75 of 100 average 0.546 secs/block after 391.2 secs
Completed block  100 of 100 average 0.5463 secs/block after 404.9 secs
====================================================
  End of a VMC section
    QMC counter        = 4
    time step          = 0.1
    reference energy   = -45.0191
    reference variance = 1.39812
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29825 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.4725e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.5019e+01
  VMC Evar = 1.3980e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0512e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.3695e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
No eigenvalues passed initial filter. Trying broader 100 a.u. filter
  Execution time (eigenvalue) = 2.9139e-04

Among totally 21 optimized parameters, largest LM parameter change : 7.7991e-03 at parameter 0
Effective weight of all the samples measured by correlated sampling is 9.9981e-01

******************************************************************************
Init Cost =  -4.0377e+01    New Cost =  -4.0376e+01  Delta Cost =   9.9640e-04
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   6.2500e-02
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.279556e-01    1  ON     0
    eC_1                -2.678100e-01    1  ON     1
    eC_2                -2.148819e-01    1  ON     2
    eC_3                -1.486402e-01    1  ON     3
    eC_4                -8.853507e-02    1  ON     4
    eC_5                -4.047648e-02    1  ON     5
    eC_6                -1.193666e-02    1  ON     6
    uu_0                 3.597412e-01    1  ON     7
    uu_1                 2.622018e-01    1  ON     8
    uu_2                 1.851262e-01    1  ON     9
    uu_3                 1.225346e-01    1  ON    10
    uu_4                 7.500160e-02    1  ON    11
    uu_5                 3.943958e-02    1  ON    12
    uu_6                 1.793610e-02    1  ON    13
    ud_0                 5.608102e-01    1  ON    14
    ud_1                 3.833385e-01    1  ON    15
    ud_2                 2.521186e-01    1  ON    16
    ud_3                 1.559819e-01    1  ON    17
    ud_4                 9.014454e-02    1  ON    18
    ud_5                 4.511151e-02    1  ON    19
    ud_6                 2.021783e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s004.vp.h5
  Updated wavefunction xml file diaqmc.s004.opt.xml
  QMCLinearOptimizeBatched Execution time = 85.88 secs

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s005
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s005
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29786 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29785 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29783 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.6407e-02 secs
Completed block    1 of 100 average 0.55 secs/block after 436.7 secs
Completed block   25 of 100 average 0.5391 secs/block after 449.6 secs
Completed block   50 of 100 average 0.5399 secs/block after 463.2 secs
Completed block   75 of 100 average 0.54 secs/block after 476.7 secs
Completed block  100 of 100 average 0.5394 secs/block after 490.1 secs
====================================================
  End of a VMC section
    QMC counter        = 5
    time step          = 0.1
    reference energy   = -45.027
    reference variance = 1.4351
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29755 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.4041e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.5027e+01
  VMC Evar = 1.4351e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0592e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.4004e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
  Execution time (eigenvalue) = 2.8269e-04

Among totally 21 optimized parameters, largest LM parameter change : 5.9253e-03 at parameter 7
Effective weight of all the samples measured by correlated sampling is 9.9978e-01

******************************************************************************
Init Cost =  -4.0381e+01    New Cost =  -4.0383e+01  Delta Cost =  -1.7505e-03
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   1.5625e-02
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.281523e-01    1  ON     0
    eC_1                -2.669304e-01    1  ON     1
    eC_2                -2.144517e-01    1  ON     2
    eC_3                -1.494231e-01    1  ON     3
    eC_4                -9.068948e-02    1  ON     4
    eC_5                -4.136318e-02    1  ON     5
    eC_6                -1.183176e-02    1  ON     6
    uu_0                 3.538160e-01    1  ON     7
    uu_1                 2.577835e-01    1  ON     8
    uu_2                 1.830327e-01    1  ON     9
    uu_3                 1.208224e-01    1  ON    10
    uu_4                 7.449927e-02    1  ON    11
    uu_5                 3.918586e-02    1  ON    12
    uu_6                 1.771026e-02    1  ON    13
    ud_0                 5.631453e-01    1  ON    14
    ud_1                 3.839555e-01    1  ON    15
    ud_2                 2.527777e-01    1  ON    16
    ud_3                 1.574209e-01    1  ON    17
    ud_4                 9.122655e-02    1  ON    18
    ud_5                 4.522477e-02    1  ON    19
    ud_6                 2.014274e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s005.vp.h5
  Updated wavefunction xml file diaqmc.s005.opt.xml
  QMCLinearOptimizeBatched Execution time = 85.24 secs

=========================================================
  Start QMCLinearOptimizeBatched
  File Root diaqmc.s006
=========================================================
  Random walking without drift
 Legacy constructor adding a default LocalEnergyEstimator for the MainEstimator 

=========================================================
  Start VMCBatched
  File Root diaqmc.s006
=========================================================
==============================================================
--- Memory usage report : VMCBatched before initialization ---
==============================================================
Available memory on node 0, free + buffers :   29826 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
==============================================================
VMCBatched Driver running with
             total_walkers     = 4
             walkers_per_rank  = [4]
             num_crowds        = 4
  on rank 0, walkers_per_crowd = [1(x4)]

                         steps = 50 (different from input value 0)
                        blocks = 100

VMCBatched Driver collecting samples, samples per rank = 20000
                                      total samples    = 20000

 Using QMCCostFunctionBatched::QMCCostFunctionBatched
 TrialWaveFunction "psi0" has 3 optimizable objects:
   'eC' optimized
   'uu' optimized
   'ud' optimized
 Variational subset selects 21 parameters.
 In total 21 parameters being optimized after applying constraints.
 Using Default Cost Function: Cost = <|E-E_ff|^2>

******************
Generating samples
******************

===================================================================
--- Memory usage report : VMCBatched after initialLogEvaluation ---
===================================================================
Available memory on node 0, free + buffers :   29826 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
===================================================================
=====================================================
--- Memory usage report : VMCBatched after Warmup ---
=====================================================
Available memory on node 0, free + buffers :   29826 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=====================================================
VMC Warmup completed in 8.9153e-02 secs
Completed block    1 of 100 average 0.5371 secs/block after 521.9 secs
Completed block   25 of 100 average 0.5291 secs/block after 534.6 secs
Completed block   50 of 100 average 0.528 secs/block after 547.8 secs
Completed block   75 of 100 average 0.5283 secs/block after 561 secs
Completed block  100 of 100 average 0.5275 secs/block after 574.2 secs
====================================================
  End of a VMC section
    QMC counter        = 6
    time step          = 0.1
    reference energy   = -45.0184
    reference variance = 1.43187
====================================================
=============================================
--- Memory usage report : VMCBatched ends ---
=============================================
Available memory on node 0, free + buffers :   29824 MiB
Memory footprint by rank 0 on node 0       :     585 MiB
=============================================
  Carry over 4 walker configurations to the next QMC driver.
  Execution time (sampling) = 5.2848e+01

*****************************
Compute parameter derivatives
*****************************

 Found 2 wavefunction dependent components in the Hamiltonian 'Kinetic' 'NonLocalECP'.
  VMC Eavg = -4.5018e+01
  VMC Evar = 1.4319e+00
  Total weights = 2.0000e+04
  Execution time (derivatives) = 2.0803e+01

*****************************************
Building overlap and Hamiltonian matrices
*****************************************
  Execution time (building matrices) = 2.4355e-01

**************************
Solving eigenvalue problem
**************************
  Using inverse + regular eigenvalue solver (geev)
No eigenvalues passed initial filter. Trying broader 100 a.u. filter
  Execution time (eigenvalue) = 2.8510e-04

Among totally 21 optimized parameters, largest LM parameter change : 5.3186e-03 at parameter 8
Effective weight of all the samples measured by correlated sampling is 9.9978e-01

******************************************************************************
Init Cost =  -4.0373e+01    New Cost =  -4.0373e+01  Delta Cost =   3.9138e-05
******************************************************************************

The new set of parameters is valid. Updating the trial wave function!

*****************************************************************************
Applying the update for shift_i =   1.0000e-02     and shift_s =   3.9062e-03
*****************************************************************************
  Updated wave function parameters:
    Name                        Value Type Use Index
    ---- ---------------------------- ---- --- -----
    eC_0                -3.236237e-01    1  ON     0
    eC_1                -2.633173e-01    1  ON     1
    eC_2                -2.109232e-01    1  ON     2
    eC_3                -1.458814e-01    1  ON     3
    eC_4                -8.676654e-02    1  ON     4
    eC_5                -3.949534e-02    1  ON     5
    eC_6                -1.102778e-02    1  ON     6
    uu_0                 3.591086e-01    1  ON     7
    uu_1                 2.631021e-01    1  ON     8
    uu_2                 1.853809e-01    1  ON     9
    uu_3                 1.217033e-01    1  ON    10
    uu_4                 7.416519e-02    1  ON    11
    uu_5                 3.804622e-02    1  ON    12
    uu_6                 1.765823e-02    1  ON    13
    ud_0                 5.609406e-01    1  ON    14
    ud_1                 3.821662e-01    1  ON    15
    ud_2                 2.514015e-01    1  ON    16
    ud_3                 1.562157e-01    1  ON    17
    ud_4                 9.048137e-02    1  ON    18
    ud_5                 4.523007e-02    1  ON    19
    ud_6                 2.011418e-02    1  ON    20

  Updated wavefunction vp file diaqmc.s006.vp.h5
  Updated wavefunction xml file diaqmc.s006.opt.xml
  QMCLinearOptimizeBatched Execution time = 84.37 secs
  Total Execution time = 603.1 secs

=========================================================
  A new xml input file : diaqmc.s006.cont.xml

Use --enable-timers=<value> command line option to increase or decrease level of timing information
Stack timer profile
Timer                       Inclusive_time  Exclusive_time  Calls       Time_per_call
Total                        605.3192     0.0189              1     605.319227354
  QMCLinearOptimizeBatched   603.0598   603.0598              7      86.151397068
  Startup                      2.2405     2.2405              1       2.240527054

QMCPACK execution completed successfully
